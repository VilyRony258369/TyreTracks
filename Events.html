<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bicycle Events India - Find & Share Cycling Events</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header */
        header {
            background: rgba(255, 255, 255, 0.98);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
            backdrop-filter: blur(10px);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        .logo h1 {
            font-size: 24px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .add-event-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 28px;
            border-radius: 25px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        .add-event-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 25px rgba(102, 126, 234, 0.6);
        }

        /* Hero Section */
        .hero {
            text-align: center;
            padding: 60px 20px;
            color: white;
        }

        .hero h2 {
            font-size: 48px;
            margin-bottom: 15px;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }

        .hero p {
            font-size: 20px;
            opacity: 0.95;
            text-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        /* Main Content */
        .main-content {
            background: white;
            border-radius: 30px 30px 0 0;
            padding: 40px 20px;
            min-height: 100vh;
            margin-top: 40px;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            padding: 20px;
            overflow-y: auto;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 20px;
            padding: 40px;
            max-width: 800px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
            from {
                transform: translateY(50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .modal-header h3 {
            font-size: 28px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 32px;
            cursor: pointer;
            color: #999;
            transition: color 0.3s;
        }

        .close-btn:hover {
            color: #333;
        }

        /* Form Styles */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        .form-group label {
            font-weight: 600;
            margin-bottom: 8px;
            color: #555;
            font-size: 14px;
        }

        .form-group label .required {
            color: #e74c3c;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            padding: 12px 16px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 15px;
            transition: all 0.3s;
            font-family: inherit;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }

        .form-actions {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }

        .btn {
            padding: 14px 32px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            flex: 1;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: #f0f0f0;
            color: #666;
        }

        .btn-secondary:hover {
            background: #e0e0e0;
        }

        /* Search & Filter */
        .search-filter {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 40px;
        }

        .search-box,
        .filter-box {
            position: relative;
        }

        .search-box input,
        .filter-box select {
            width: 100%;
            padding: 15px 45px 15px 50px;
            border: 2px solid #e0e0e0;
            border-radius: 15px;
            font-size: 15px;
            transition: all 0.3s;
        }

        .search-box input:focus,
        .filter-box select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .search-icon,
        .filter-icon {
            position: absolute;
            left: 18px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 20px;
            color: #999;
        }

        /* Events Section */
        .events-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .events-header h3 {
            font-size: 32px;
            color: #333;
        }

        .events-count {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: 600;
        }

        .events-grid {
            display: grid;
            gap: 25px;
        }

        .event-card {
            background: white;
            border: 2px solid #f0f0f0;
            border-radius: 20px;
            padding: 30px;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .event-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 5px;
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            transform: scaleY(0);
            transition: transform 0.3s;
        }

        .event-card:hover {
            border-color: #667eea;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.15);
            transform: translateY(-5px);
        }

        .event-card:hover::before {
            transform: scaleY(1);
        }

        .event-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 15px;
        }

        .event-title {
            font-size: 24px;
            font-weight: 700;
            color: #333;
            margin-bottom: 10px;
        }

        .difficulty-badge {
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .difficulty-beginner {
            background: #d4edda;
            color: #155724;
        }

        .difficulty-intermediate {
            background: #fff3cd;
            color: #856404;
        }

        .difficulty-advanced {
            background: #f8d7da;
            color: #721c24;
        }

        .event-description {
            color: #666;
            line-height: 1.6;
            margin-bottom: 20px;
        }

        .event-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .event-detail {
            display: flex;
            align-items: center;
            gap: 10px;
            color: #555;
            font-size: 14px;
        }

        .event-detail-icon {
            width: 36px;
            height: 36px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 16px;
        }

        .event-detail strong {
            color: #333;
            font-weight: 600;
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 80px 20px;
        }

        .empty-state-icon {
            width: 120px;
            height: 120px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 30px;
            font-size: 60px;
            opacity: 0.8;
        }

        .empty-state h3 {
            font-size: 28px;
            margin-bottom: 15px;
            color: #333;
        }

        .empty-state p {
            font-size: 18px;
            color: #666;
        }

        /* Loading */
        .loading {
            text-align: center;
            padding: 60px 20px;
        }

        .spinner {
            width: 60px;
            height: 60px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Footer */
        footer {
            background: white;
            text-align: center;
            padding: 30px 20px;
            color: #666;
            border-top: 2px solid #f0f0f0;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .hero h2 {
                font-size: 32px;
            }

            .hero p {
                font-size: 16px;
            }

            .search-filter {
                grid-template-columns: 1fr;
            }

            .modal-content {
                padding: 25px;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }

            .form-actions {
                flex-direction: column;
            }

            .event-details {
                grid-template-columns: 1fr;
            }

            .logo h1 {
                font-size: 18px;
            }

            .add-event-btn {
                padding: 10px 20px;
                font-size: 14px;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <div class="logo-icon">üö¥</div>
                    <h1>Bicycle Events India</h1>
                </div>
                <button class="add-event-btn" onclick="openModal()">‚ûï Add Event</button>
            </div>
        </div>
    </header>

    <div class="hero">
        <div class="container">
            <h2>Discover Cycling Events Across India</h2>
            <p>Connect with fellow cyclists and join amazing rides near you</p>
        </div>
    </div>

    <div class="main-content">
        <div class="container">
            <div class="search-filter">
                <div class="search-box">
                    <span class="search-icon">üîç</span>
                    <input type="text" id="searchInput" placeholder="Search events by name, city, or state..." onkeyup="filterEvents()">
                </div>
                <div class="filter-box">
                    <span class="filter-icon">üìç</span>
                    <select id="stateFilter" onchange="filterEvents()">
                        <option value="all">All States</option>
                    </select>
                </div>
            </div>

            <div class="events-header">
                <h3>Upcoming Events</h3>
                <span class="events-count" id="eventsCount">0 Events</span>
            </div>

            <div id="eventsContainer">
                <div class="loading">
                    <div class="spinner"></div>
                    <p>Loading events...</p>
                </div>
            </div>
        </div>
    </div>

    <footer>
        <div class="container">
            <p>üö¥‚Äç‚ôÇÔ∏è Share your bicycle events and ride together! Data is shared across all users.</p>
            <p style="margin-top: 10px; font-size: 14px;">Made with ‚ù§Ô∏è for the cycling community in India</p>
        </div>
    </footer>

    <!-- Modal -->
    <div class="modal" id="eventModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Create New Event</h3>
                <button class="close-btn" onclick="closeModal()">&times;</button>
            </div>
            
            <div class="form-grid">
                <div class="form-group">
                    <label>Event Title <span class="required">*</span></label>
                    <input type="text" id="title" placeholder="Sunday Morning Ride">
                </div>
                <div class="form-group">
                    <label>Organizer Name <span class="required">*</span></label>
                    <input type="text" id="organizer" placeholder="Your name or club name">
                </div>
                <div class="form-group">
                    <label>Date <span class="required">*</span></label>
                    <input type="date" id="date">
                </div>
                <div class="form-group">
                    <label>Time <span class="required">*</span></label>
                    <input type="time" id="time">
                </div>
                <div class="form-group">
                    <label>City <span class="required">*</span></label>
                    <input type="text" id="city" placeholder="Mumbai">
                </div>
                <div class="form-group">
                    <label>State <span class="required">*</span></label>
                    <select id="state">
                        <option value="">Select State</option>
                    </select>
                </div>
                <div class="form-group full-width">
                    <label>Location/Meeting Point <span class="required">*</span></label>
                    <input type="text" id="location" placeholder="Gateway of India, Colaba">
                </div>
                <div class="form-group">
                    <label>Contact (Email/Phone) <span class="required">*</span></label>
                    <input type="text" id="contact" placeholder="email@example.com or +91-XXXXXXXXXX">
                </div>
                <div class="form-group">
                    <label>Expected Participants</label>
                    <input type="number" id="participants" placeholder="50">
                </div>
                <div class="form-group">
                    <label>Difficulty Level</label>
                    <select id="difficulty">
                        <option value="beginner">Beginner</option>
                        <option value="intermediate">Intermediate</option>
                        <option value="advanced">Advanced</option>
                    </select>
                </div>
                <div class="form-group full-width">
                    <label>Description <span class="required">*</span></label>
                    <textarea id="description" placeholder="Describe your event, route, what to bring, etc."></textarea>
                </div>
            </div>

            <div class="form-actions">
                <button class="btn btn-primary" onclick="submitEvent()">Submit Event</button>
                <button class="btn btn-secondary" onclick="closeModal()">Cancel</button>
            </div>
        </div>
    </div>

    <script>
        const indianStates = [
            'Andhra Pradesh', 'Arunachal Pradesh', 'Assam', 'Bihar', 'Chhattisgarh',
            'Goa', 'Gujarat', 'Haryana', 'Himachal Pradesh', 'Jharkhand', 'Karnataka',
            'Kerala', 'Madhya Pradesh', 'Maharashtra', 'Manipur', 'Meghalaya', 'Mizoram',
            'Nagaland', 'Odisha', 'Punjab', 'Rajasthan', 'Sikkim', 'Tamil Nadu',
            'Telangana', 'Tripura', 'Uttar Pradesh', 'Uttarakhand', 'West Bengal',
            'Delhi', 'Puducherry', 'Jammu and Kashmir', 'Ladakh'
        ];

        let allEvents = [];

        // Initialize
        window.addEventListener('DOMContentLoaded', () => {
            populateStates();
            loadEvents();
        });

        function populateStates() {
            const stateSelect = document.getElementById('state');
            const stateFilter = document.getElementById('stateFilter');
            
            indianStates.forEach(state => {
                const option1 = document.createElement('option');
                option1.value = state;
                option1.textContent = state;
                stateSelect.appendChild(option1);

                const option2 = document.createElement('option');
                option2.value = state;
                option2.textContent = state;
                stateFilter.appendChild(option2);
            });
        }

        async function loadEvents() {
            try {
                const result = await window.storage.list('event:', true);
                if (result && result.keys) {
                    const promises = result.keys.map(async (key) => {
                        try {
                            const data = await window.storage.get(key, true);
                            return data ? JSON.parse(data.value) : null;
                        } catch {
                            return null;
                        }
                    });
                    allEvents = (await Promise.all(promises))
                        .filter(e => e !== null)
                        .sort((a, b) => new Date(a.date) - new Date(b.date));
                }
            } catch (error) {
                console.log('No events found yet');
            }
            displayEvents(allEvents);
        }

        function displayEvents(events) {
            const container = document.getElementById('eventsContainer');
            const countElement = document.getElementById('eventsCount');
            
            countElement.textContent = `${events.length} Event${events.length !== 1 ? 's' : ''}`;

            if (events.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">üö¥</div>
                        <h3>No events found</h3>
                        <p>Be the first to add a cycling event!</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = events.map(event => `
                <div class="event-card">
                    <div class="event-header">
                        <div>
                            <h4 class="event-title">${event.title}</h4>
                        </div>
                        <div class="difficulty-badge difficulty-${event.difficulty}">
                            ${event.difficulty}
                        </div>
                    </div>
                    <p class="event-description">${event.description}</p>
                    <div class="event-details">
                        <div class="event-detail">
                            <div class="event-detail-icon">üìÖ</div>
                            <div>
                                <strong>Date & Time</strong><br>
                                ${new Date(event.date).toLocaleDateString('en-IN', { 
                                    day: 'numeric', 
                                    month: 'long', 
                                    year: 'numeric' 
                                })} at ${event.time}
                            </div>
                        </div>
                        <div class="event-detail">
                            <div class="event-detail-icon">üìç</div>
                            <div>
                                <strong>Location</strong><br>
                                ${event.location}, ${event.city}, ${event.state}
                            </div>
                        </div>
                        ${event.participants ? `
                        <div class="event-detail">
                            <div class="event-detail-icon">üë•</div>
                            <div>
                                <strong>Expected</strong><br>
                                ${event.participants} participants
                            </div>
                        </div>
                        ` : ''}
                        <div class="event-detail">
                            <div class="event-detail-icon">üë§</div>
                            <div>
                                <strong>Organizer</strong><br>
                                ${event.organizer}
                            </div>
                        </div>
                        <div class="event-detail">
                            <div class="event-detail-icon">üìû</div>
                            <div>
                                <strong>Contact</strong><br>
                                ${event.contact}
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function filterEvents() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const stateFilter = document.getElementById('stateFilter').value;

            const filtered = allEvents.filter(event => {
                const matchesSearch = event.title.toLowerCase().includes(searchTerm) ||
                                    event.city.toLowerCase().includes(searchTerm) ||
                                    event.state.toLowerCase().includes(searchTerm);
                const matchesState = stateFilter === 'all' || event.state === stateFilter;
                return matchesSearch && matchesState;
            });

            displayEvents(filtered);
        }

        function openModal() {
            document.getElementById('eventModal').classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeModal() {
            document.getElementById('eventModal').classList.remove('active');
            document.body.style.overflow = 'auto';
            clearForm();
        }

        function clearForm() {
            document.getElementById('title').value = '';
            document.getElementById('organizer').value = '';
            document.getElementById('date').value = '';
            document.getElementById('time').value = '';
            document.getElementById('city').value = '';
            document.getElementById('state').value = '';
            document.getElementById('location').value = '';
            document.getElementById('contact').value = '';
            document.getElementById('participants').value = '';
            document.getElementById('difficulty').value = 'beginner';
            document.getElementById('description').value = '';
        }

        async function submitEvent() {
            const formData = {
                title: document.getElementById('title').value,
                organizer: document.getElementById('organizer').value,
                date: document.getElementById('date').value,
                time: document.getElementById('time').value,
                city: document.getElementById('city').value,
                state: document.getElementById('state').value,
                location: document.getElementById('location').value,
                contact: document.getElementById('contact').value,
                participants: document.getElementById('participants').value,
                difficulty: document.getElementById('difficulty').value,
                description: document.getElementById('description').value
            };

            if (!formData.title || !formData.organizer || !formData.date || !formData.time || 
                !formData.city || !formData.state || !formData.location || 
                !formData.contact || !formData.description) {
                alert('Please fill all required fields marked with *');
                return;
            }

            const newEvent = {
                ...formData,
                id: Date.now().toString(),
                createdAt: new Date().toISOString()
            };

            try {
                await window.storage.set(`event:${newEvent.id}`, JSON.stringify(newEvent), true);
                allEvents.push(newEvent);
                allEvents.sort((a, b) => new Date(a.date) - new Date(b.date));
                displayEvents(allEvents);
                closeModal();
                alert('üéâ Event created successfully!');
            } catch (error) {
                alert('‚ùå Failed to save event. Please try again.');
            }
        }

        // Close modal on outside click
        document.getElementById('eventModal').addEventListener('click', (e) => {
            if (e.target.id === 'eventModal') {
                closeModal();
            }
        });
    </script>
</body>
</html>